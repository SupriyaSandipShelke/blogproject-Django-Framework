{% extends 'blog/base.html' %}

{% block content %}
<style>
    .post-img {
        max-height: 400px;
        object-fit: cover;
    }
</style>

<div class="card shadow">
  {% if post.image %}
    <img src="{{ post.image.url }}" class="card-img-top post-img">
  {% else %}
    <div class="card-img-top post-img" style="background-color: #e9ecef; display: flex; align-items: center; justify-content: center;">
      <span class="text-muted">No Image</span>
    </div>
  {% endif %}

  <div class="card-body">
    <h2>{{ post.title }}</h2>
    <p class="text-muted">
      By {{ post.author.username }} |
      {{ post.created_at|date:"d M Y" }}
    </p>

    <p>{{ post.content }}</p>

    {% if user == post.author %}
      <a href="{% url 'edit_post' post.id %}" class="btn btn-warning btn-sm">Edit</a>
      <a href="{% url 'delete_post' post.id %}" class="btn btn-danger btn-sm">Delete</a>
    {% endif %}
  </div>
</div>

<hr>

<h5>Comments</h5>

{% for comment in comments %}
  <div class="mb-2">
    <strong>{{ comment.user.username }}</strong> :
    {{ comment.text }}
  </div>
{% empty %}
  <p>No comments yet.</p>
{% endfor %}

{% if user.is_authenticated %}
<form method="POST" class="mt-3">
  {% csrf_token %}
  <textarea name="text" class="form-control" placeholder="Add a comment..." required></textarea>
  <button class="btn btn-primary btn-sm mt-2">Comment</button>
</form>
{% else %}
<p class="text-danger">Login to comment</p>
{% endif %}

{% endblock %}
